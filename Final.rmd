---
title: "Covid91 vaccine study Final2025"
author: "Zanya Davenport"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="finalSumr2024.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
Males = filter(FinalData, sex =="M")
Female = filter(FinalData, sex =="F")
gay = filter(FinalData, LGBTQ =="gay")
Druguser = filter(FinalData, DrugUser =="yes")
```

# Introduction

A new  preventative vaccine (covid921) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

## Males

## Barplot  

```{r}
dd2 <- Males %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))
# the group_by followed by summarize(count=n())

basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```
This plot represents the population of Males and their relationship to the contraction of covid-19 by either taking the vaccine or the placebo.
The plot above shows that roughly 25% of the people that took the vaccine did in fact get covid-19, while approximately 65% of the people taking the placebo contracted covid-19.  A substantially higher percentage of people who took that placebo contracted covid-19 versus those who were only given the vaccine. The vaccine appears to be effective in the protection against covid-19.

## Numerical Results 

```{r}
table1 <- xtabs(~infected + treatment, data=Males)
rowPerc(table1)
colPerc(table1)
```

These numerical results show specific percentages of Males that got covid-19 after taking the placebo and taking the vaccine. Among the Males, 73.8% got covid-19 after taking the placebo, while the approximately 26.2% of guys that were given the vaccine contracted covid-19. The vaccine is clearly effective in preventing covid-19 in males and is  recommended. Those who took the placebo were more likely to contract covid-19.


### Inferential 

```{r}
chisq.test(table1)
chisqtestGC(table1)
Malesfish <- fisher.test(table1)
Malesfish
```

 The p-value displayed above is at 2.2e-16. This is an ok number.Seeing this number means that these results are likely to occur by chance.




```{r}
effect <- Malesfish$p.value/(Malesfish$p.value +1)
effectivenessMales = Malesfish$estimate/(Malesfish$estimate +1)*100
print(effectivenessMales)
```

```{r}
low=(Malesfish$conf.int[1]/(Malesfish$conf.int[1] +1))*100
hi=(Malesfish$conf.int[2]/(Malesfish$conf.int[2] +1))*100
options(digits=2)
```

## Effectiveness Confidence Interval `r low`  to `r hi`



Above is the effectiveness for the covid-19 vaccine for males. If the effectiveness is above 50% that means that the vaccine is effective. Based on the interval seen above, we can conclude that the vaccine is effective in protecting males from getting covid-19. 

The odds ratio is approximately how effective the vaccine is. The odds ratio for the guys can be seen above as 70. The effectiveness confidence interval for the guys is 68.85 to 78.32.


## Females

### Barplot

```{r}
dd3 <- Female %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))
# the group_by followed by summarize(count=n())

basicC <- ggplot(dd3,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd3,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

This plot represents the population of females and their relationship to the contraction of covid-19 by either taking the vaccine or the placebo.
The plot above shows that roughly 35% of the people that took the vaccine did in fact get covid-19, while approximately 65% of the people taking the placebo contracted covid-19. A substantially higher percentage of people who took that placebo contracted covid-19 versus those who were only given the vaccine. The vaccine appears to be effective in the protection against covid-19.  

#### Numerical Results 

```{r}
table2<- xtabs(~infected + treatment, data=Males)
rowPerc(table2)
colPerc(table2)
```

These numerical results show specific percentages of females that got covid-19 after taking the placebo and taking the vaccine. Among the females, 74% got covid-19 after taking the placebo, while the approximately 26% of guys that were given the vaccine contracted covid-19. The vaccine is clearly effective in preventing covid-19 in males and is  recommended. Those who took the placebo were more likely to contract covid-19.

##### Infrential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
Femalefish <- fisher.test(table1)
Femalefish
```

The p-value displayed above is at 2.2e-16. This is an ok number.Seeing this number means that these results are likely to occur by chance. 

```{r}
effect <- Femalefish$p.value/(Femalefish$p.value +1)
effectivenessFemales = Femalefish$estimate/(Femalefish$estimate +1)*100
print(effectivenessFemales)
```

```{r}
low=(Femalefish$conf.int[1]/(Femalefish$conf.int[1] +1))*100
hi=(Femalefish$conf.int[2]/(Femalefish$conf.int[2] +1))*100
options(digits=2)
```

## Effectiveness Confidence Interval `r low`  to `r hi`



Above is the effectiveness for the covid-19 vaccine for females. If the effectiveness is above 50% that means that the vaccine is effective. Based on the interval seen above, we can conclude that the vaccine is effective in protecting females from getting covid-19. 

The odds ratio is approximately how effective the vaccine is. The odds ratio for the females can be seen above as 74. The effectiveness confidence interval for the females is 68.85 to 78.32.

## LGBTQ
### Barplot

```{r}
dd4 <- gay %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))
# the group_by followed by summarize(count=n())

basicC <- ggplot(dd4,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd4,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

This plot represents the population of gays and their relationship to the contraction of covid-19 by either taking the vaccine or the placebo.
The plot above shows that roughly 20% of the people that took the vaccine did in fact get covid-19, while approximately 80% of the people taking the placebo contracted covid-19.  A substantially higher percentage of people who took that placebo contracted covid-19 versus those who were only given the vaccine. The vaccine appears to be effective in the protection against covid-19.

#### Numerical Results

```{r}
table3 <- xtabs(~infected + treatment, data=gay)
rowPerc(table3)
colPerc(table3)
```

These numerical results show specific percentages of gays that got covid-19 after taking the placebo and taking the vaccine. Among the gays, 80% got covid-19 after taking the placebo, while the approximately 20% of gays that were given the vaccine contracted covid-19. The vaccine is clearly effective in preventing covid-19 in gays and is  recommended. Those who took the placebo were more likely to contract covid-19.

##### Infrential Results

```{r}
chisq.test(table3)
chisqtestGC(table3)
gayfish <- fisher.test(table3)
gayfish
```

 The p-value displayed above is at 7e-07. This is a large number.Seeing this number means that these results are likely to occur by chance. 
 
```{r}
effect <- gayfish$p.value/(gayfish$p.value +1)
effectivenessgay = gayfish$estimate/(gayfish$estimate +1)*100
print(effectivenessgay)
```
 
```{r}
low=(gayfish$conf.int[1]/(gayfish$conf.int[1] +1))*100
hi=(gayfish$conf.int[2]/(gayfish$conf.int[2] +1))*100
options(digits=2)
```

## Effectiveness Confidence Interval `r low`  to `r hi`



Above is the effectiveness for the covid-19 vaccine for gays. If the effectiveness is above 50% that means that the vaccine is effective. Based on the interval seen above, we can conclude that the vaccine is effective in protecting gays from getting covid-19. 

The odds ratio is approximately how effective the vaccine is. The odds ratio for the gays can be seen above as 80. The effectiveness confidence interval for the guys is  68.99 to 89.88.


## Druggies  

### Barplot

```{r}
dd5 <- Druguser %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))
# the group_by followed by summarize(count=n())

basicC <- ggplot(dd5,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd5,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

This plot represents the population of drugusers and their relationship to the contraction of covid-19 by either taking the vaccine or the placebo.
The plot above shows that roughly 95% of the people that took the vaccine did in fact get covid-19, while approximately 8% of the people taking the placebo contracted covid-19. A substantially higher percentage of people who took vaccine contracted covid-19 versus those who were only given the placebo. The vaccine appears to be ineffective in the protection against covid-19.  

#### Numerical Results 


```{r}
table4<- xtabs(~infected + treatment, data=Druguser)
rowPerc(table4)
colPerc(table4)
```
These numerical results show specific percentages of Druguser that got covid-19 after taking the placebo and taking the vaccine. Among the drugusers, 8.3% got covid-19 after taking the placebo, while the approximately 91.7% of drugusers that were given the vaccine contracted covid-19. The vaccine is clearly ineffective in preventing covid-19 in drugusers and is not recommended. Those who took the vaccine were more likely to contract covid-19.

##### Infrential Results 

```{r}
chisq.test(table4)
chisqtestGC(table4)
Druguserfish <- fisher.test(table4)
Druguserfish
```

The p-value displayed above is at 3e-12. This is a small number.Seeing this number means that these results are not likely to occur by chance.

```{r}
effect <- Druguserfish$p.value/(Druguserfish$p.value +1)
effectivenessDruguser = Druguserfish$estimate/(Druguserfish$estimate +1)*100
print(effectivenessDruguser)
```

```{r}
low=(Druguserfish$conf.int[1]/(Druguserfish$conf.int[1] +1))*100
hi=(Druguserfish$conf.int[2]/(Druguserfish$conf.int[2] +1))*100
options(digits=2)
```

## Effectiveness Confidence Interval `r low`  to `r hi`



Above is the effectiveness for the covid-19 vaccine for drugusers. If the effectiveness is above 50% that means that the vaccine is effective. Based on the interval seen above, we can conclude that the vaccine is ineffective in protecting drugusers from getting covid-19. 

The odds ratio is approximately how effective the vaccine is. The odds ratio for the drugusers can be seen above as 7. The effectiveness confidence interval for the drugusers is 2.65 to 17.86 .

# Overall Results and Conclusions

The covid-19 vaccine was effective in protecting men against the contraction of the disease. The covid-19 effectiveness was `r effectivenessMales`
for men. The covid-19 vaccine was successful in protecting women against covid-19.The covid-19 effectiveness was `r effectivenessFemales`.The covid-19 vaccine was most effective in treating people who identified as gay. The covid-19 effectiveness was `r effectivenessgay` for gay individuals.
The individuals that were drugusers were ineffectively protected by the vaccine. 
The drugusers that took the vaccine were more likely to get covid-19 than those taking the placebo.The covid-19 effectiveness was `r effectivenessDruguser` for drugusers.

If you are druguser it is not recommended to receive the vaccine. However, if you are gay, female or male (non-druguser) , the vaccine was reported to have been effective.
The null that there is no difference in taking the vaccine can not be accepted to the categories including drugusers. The alternative, that the vaccine works and is effective, can be accepted for the women, men,and the people who are gay.
